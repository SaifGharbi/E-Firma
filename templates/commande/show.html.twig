{% extends is_granted('ROLE_ADMIN') ? 'base_admin.html.twig' : 'base.html.twig' %}

{% block title %}Commande Details{% endblock %}

{% block body %}
    <div class="container">
        <h1>Order Details</h1>
        <table class="table">
            <tbody>
                <tr><th>Date</th><td>{{ commande.date ? commande.date|date('Y-m-d H:i:s') : '' }}</td></tr>
                <tr><th>Total</th><td>{{ commande.total }}</td></tr>
                <tr><th>Status</th><td>{{ commande.statut ? 'Processed' : 'Pending' }}</td></tr>
            </tbody>
        </table>

        {% if (is_granted('ROLE_AGRICULTEUR') or is_granted('ROLE_CLIENT')) and commande.client == app.user %}
            <div class="action-buttons">
                {% if commande.statut == 'pending' %}
                    <a href="{{ path('app_commande_edit', {'id': commande.id}) }}" 
                       class="btn btn-primary">Modify Order</a>
                    <a href="{{ path('app_commande_cancel', {'id': commande.id}) }}" 
                       class="btn btn-danger">Cancel Order</a>
                {% endif %}
                
                {% if commande.statut == 'confirmed' %}
                    <a href="{{ path('app_livraison_new', {'commande': commande.id}) }}" 
                       class="btn btn-success">Request Delivery</a>
                {% endif %}
            </div>
        {% endif %}
    </div>
{% endblock %}
